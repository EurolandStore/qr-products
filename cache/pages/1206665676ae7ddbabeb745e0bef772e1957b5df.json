{
  "url": "https://stackoverflow.com/questions/49897380/access-vba-search-while-you-type-in-textbox-from-listbox",
  "title": "Access VBA :Search while you type in Textbox from Listbox - Stack Overflow",
  "text": "If you have Listbox with a rowsource like: SELECT CustomerID, CompanyName, Phone, Fax FROM Customers ORDER BY CustomerID then use code-behind similar to: 'Search string for the list box. Private strLstSearch As String ' Listing A Private Sub SetTyped() 'Display current typed or selected value. Me!txtSearch.Value = strLstSearch End Sub ' Listing B Private Sub lstPhone_KeyPress(KeyAscii As Integer) 'Select item in list box Dim lst As ListBox Dim rst As ADODB.Recordset Dim lngKeyLen As Long Dim booReset As Boolean Set lst = Me.ActiveControl 'Determine keyboard input 'and respond accordingly. Select Case KeyAscii Case vbKeyBack 'Cancel last key press. lngKeyLen = Len(strLstSearch) If lngKeyLen > 0 Then strLstSearch = Left(strLstSearch, lngKeyLen - 1) If lngKeyLen = 1 Then 'Search string is empty. Reset listbox. booReset = True End If End If Case vbKeyEscape 'Reset search string and listbox. strLstSearch = vbNullString booReset = True Case vbKeyReturn, vbKeyTab 'Keeps Tab and Enter from being trapped. Case Else 'Set search string value strLstSearch = strLstSearch & Chr(KeyAscii) 'Inhibit normal stepping in listbox. KeyAscii = 0 End Select lngKeyLen = Len(strLstSearch) If booReset = True Then 'Reset listbox. lst.Value = lst.ItemData(Abs(lst.ColumnHeads)) ElseIf lngKeyLen > 0 Then 'Search listbox using the rowsource. Set rst = New ADODB.Recordset rst.Open lst.RowSource, CurrentProject.Connection, _ adOpenStatic, adLockPessimistic With rst If .RecordCount > 0 Then .Find \"CustomerID Like '\" & strLstSearch _ & \"*'\" If .EOF Then 'Skip key entry and notify user. strLstSearch = Left(strLstSearch, lngKeyLen - 1) DoCmd.Beep Else 'Set listbox to located match. lst.Value = .Fields(lst.BoundColumn - 1).Value End If End If .Close End With End If 'Display current value. Call SetTyped Set rst = Nothing Set lst = Nothing ExitHere: Set rst = Nothing Set lst = Nothing Exit Sub ErrHandler: MsgBox Err.Number & \" \" & Err.Description GoTo ExitHere End Sub ' Listing C Private Sub lstPhone_Click() 'Select item clicked on. strLstSearch = Me.ActiveControl.Value Call SetTyped End Sub ' Listing D Private Sub lstPhone_GotFocus() 'Reset search string. strLstSearch = vbNullString Call SetTyped End Sub ' Listing E Private Sub lstPhone_LostFocus() 'Reset search string. strLstSearch = vbNullString Call SetTyped End Sub If youâ€™re using DAO, make the following changes to the code: - List item Add the following declaration and definition statements: Dim dbs As DAO.Database Dim rst As DAO.Recordset Set dbs = CurrentDB Delete the ADODB Recordset declaration and definition statements. Replace the rst.Open statement with the following statement: Set rst = dbs.OpenRecordset(lst.RowSource) Replace the Find method with FindFirst. - Replace the .EOF property with .NoMatch."
}
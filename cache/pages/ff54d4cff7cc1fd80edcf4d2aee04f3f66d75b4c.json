{
  "url": "https://stackoverflow.com/questions/55901233/bing-api-related-searches",
  "title": "Bing API related searches - Stack Overflow",
  "text": "How does one get related searches to be included in response from Bing search API? I am trying to apply responseFilter with value RelatedSearches as per the documentation here: https://learn.microsoft.com/en-us/rest/api/cognitiveservices/bing-web-api-v7-reference#relatedsearchanswer Below is my code based on sample from Bing. I have added \"&responseFilter=RelatedSearches\" to the URL that is fetched by file_get_contents(). The error I get back is: PHP Warning: file_get_contents(https://api.cognitive.microsoft.com/bing/v7.0/search?responseFilter=RelatedSearches&q=iphone+case): failed to open stream: HTTP request failed! HTTP/1.1 403 Forbidden Clearly I am applying it wrong. What can I change to be making it working? <?php $accessKey = 'abc123'; $endpoint = 'https://api.cognitive.microsoft.com/bing/v7.0/search'; $term = 'burrito recipe'; function BingWebSearch ($url, $key, $query) { $headers = \"Ocp-Apim-Subscription-Key: $key\\r\\n\"; $options = array ('http' => array ( 'header' => $headers, 'method' => 'GET')); $context = stream_context_create($options); $result = file_get_contents($url . \"?q=\" . urlencode($query) . \"&responseFilter=RelatedSearches\", false, $context); $headers = array(); foreach ($http_response_header as $k => $v) { $h = explode(\":\", $v, 2); if (isset($h[1])) if (preg_match(\"/^BingAPIs-/\", $h[0]) || preg_match(\"/^X-MSEdge-/\", $h[0])) $headers[trim($h[0])] = trim($h[1]); } return array($headers, $result); } if (strlen($accessKey) == 32) { print \"Searching the Web for: \" . $term . \"\\n\"; list($headers, $json) = BingWebSearch($endpoint, $accessKey, $term); print \"\\nRelevant Headers:\\n\\n\"; foreach ($headers as $k => $v) { print $k . \": \" . $v . \"\\n\"; } print \"\\nJSON Response:\\n\\n\"; echo json_encode(json_decode($json), JSON_PRETTY_PRINT); } else { print(\"Invalid Bing Search API subscription key!\\n\"); print(\"Please paste yours into the source code.\\n\"); } ?>"
}